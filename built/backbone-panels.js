//     backbone-panels
//     (c) simonfan
//     backbone-panels is licensed under the MIT terms.

define("__backbone-panels/panel-builder",["require","exports","module","lodash","backbone-ui-resizable"],function(e,n,t){{var a=(e("lodash"),e("backbone-ui-resizable"));t.exports=a.extend({handleOptions:{directions:"w,e",clss:"handle",ratio:0,thickness:25}})}}),define("__backbone-panels/iterators",["require","exports","module","lodash"],function(e,n){var t=e("lodash"),a=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","findIndex","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];t.each(a,function(e){n[e]=function(){var n=Array.prototype.slice.call(arguments);return n.unshift(this.panels),t[e].apply(t,n)}}),n.panelIndex=function(e){return this.findIndex(function(n){return n.cid===e.cid})},n.before=function(e){return this.first(e)},n.after=function(e){return this.rest(e+1)},n.reduceBefore=function(e,n,a,i){var o=this.before(e);return t.reduce(o,n,a,i)},n.reduceAfter=function(e,n,a,i){var o=this.after(e);return t.reduce(o,n,a,i)}}),define("__backbone-panels/panel-config",["require","exports","module"],function(e,n){n.sumBefore=function(e,n){return this.reduceBefore(n,function(n,t){return n+t.get(e)},0)},n.sumAfter=function(e,n){return this.reduceAfter(n,function(n,t){return n+t.get(e)},0)},n.calculateLeftPos=function(e){return this.sumBefore("width",e)},n.postitionPanel=function(e){var n=this.panelIndex(e),t=this.calculateLeftPos(n);e.model.set({left:t,top:0})},n.setPanelRightBoundaries=function(e){var n=this.panelIndex(e),t=this.sumAfter("minWidth",n),a=this.sumAfter("maxWidth",n),i=this.sumAfter("width",-1);e.model.set("maxRight",i-t),e.model.set("minRight",i-a)},n.setPanelLeftBoundaries=function(e){var n=this.panelIndex(e),t=this.sumBefore("maxWidth",n),a=this.sumBefore("minWidth",n);e.model.set("maxLeft",t),e.model.set("minLeft",a)},n.arrange=function(){this.each(function(e){this.postitionPanel(e),this.setPanelRightBoundaries(e),this.setPanelLeftBoundaries(e)},this)}}),define("__backbone-panels/event-handlers",["require","exports","module","lodash"],function(e,n){e("lodash");n.handlePanelResize=function(e,n){if("panels-control"!==n.agent){var t,a,i=this.panelIndex(e),o=Math.abs(n.delta);"expand"===n.action?"w"===n.handle?(t=this.before(i),this.contractPanelsToLeft(t,o)):"e"===n.handle&&(a=this.after(i),this.contractPanelsToRight(a,o)):"contract"===n.action&&("w"===n.handle?(t=this.before(i),this.expandPanelsToRight(t,o)):"e"===n.handle&&(a=this.after(i),this.expandPanelsToLeft(a,o)))}},n.handlePanelResizeStart=function(){},n.handlePanelResizeStop=function(){}}),define("__backbone-panels/actions",["require","exports","module","lodash"],function(e,n){e("lodash");n.contractPanelsToLeft=function(e,n){for(;e.length>0&&0!==n;){var t=e.pop();if(0===e.length)n=t.contractToLeft(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,o=t.moveToLeft(a,{agent:"panels-control"}),s=t.contractToLeft(i+o,{agent:"panels-control"});s&&t.moveToLeft(s,{agent:"panels-control"}),n=a+s}}},n.contractPanelsToRight=function(e,n){for(;e.length>0&&n>0;){var t=e.shift();if(0===e.length)n=t.contractToRight(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,o=t.moveToRight(a,{agent:"panels-control"}),s=t.contractToRight(i+o,{agent:"panels-control"});s&&t.moveToRight(s,{agent:"panels-control"}),n=a+s}}},n.expandPanelsToLeft=function(e,n){for(;e.length>0&&0!==n;){var t=e.shift();if(0===e.length)n=t.expandToLeft(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,o=t.moveToLeft(a,{agent:"panels-control"}),s=t.expandToLeft(i+o,{agent:"panels-control"});s&&t.moveToLeft(s,{agent:"panels-control"}),n=a+s}}},n.expandPanelsToRight=function(e,n){for(;e.length>0&&0!==n;){var t=e.pop();if(0===e.length)n=t.expandToRight(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,o=t.moveToRight(a,{agent:"panels-control"}),s=t.expandToRight(i+o,{agent:"panels-control"});s&&t.moveToRight(s,{agent:"panels-control"}),n=a+s}}}}),define("backbone-panels",["require","exports","module","jquery","lowercase-backbone","lodash","./__backbone-panels/panel-builder","./__backbone-panels/iterators","./__backbone-panels/panel-config","./__backbone-panels/event-handlers","./__backbone-panels/actions"],function(e,n,t){var a=e("jquery"),i=e("lowercase-backbone"),o=e("lodash"),s=t.exports=i.view.extend({initialize:function(){i.view.prototype.initialize.apply(this,arguments),this.initializePanels.apply(this,arguments)},initializePanels:function(){o.bindAll(this,"handlePanelResize","handlePanelResizeStart","handlePanelResizeStop"),this.$el.css(this.css),this.panels=[],o.each(this.$el.children(),function(e,n){var t=a(e),i=t.data();i.el=t,this.addPanel(n,i)},this),this.arrange()},panelBuilder:e("./__backbone-panels/panel-builder"),panelTemplate:"<div></div>",panelClass:"panel",addPanel:function(e,n){var t;if(n.el)t=n.el;else{var s=o.isFunction(this.panelTemplate)?this.panelTemplate(n):this.panelTemplate;t=a(s)}t.addClass(this.panelClass).appendTo(this.$el);var l=this.panelBuilder(o.extend(n,{el:t,model:i.model(n)}));this.listenTo(l,"resizestart",this.handlePanelResizeStart).listenTo(l,"resize-x",this.handlePanelResize).listenTo(l,"resizestop",this.handlePanelResizeStop),this.panels.splice(e,1,l)},css:{position:"relative"}});s.proto(e("./__backbone-panels/iterators")),s.proto(e("./__backbone-panels/panel-config")),s.proto(e("./__backbone-panels/event-handlers")),s.proto(e("./__backbone-panels/actions"))});