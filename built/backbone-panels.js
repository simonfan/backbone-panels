//     backbone-panels
//     (c) simonfan
//     backbone-panels is licensed under the MIT terms.

define("__backbone-panels/panel-builder",["require","exports","module","lodash","backbone-ui-resizable"],function(e,n,t){{var a=(e("lodash"),e("backbone-ui-resizable"));t.exports=a.extend({initialize:function(e){a.prototype.initialize.call(this,e),this.$el.addClass(this.panelClass),this.id=this.$el.prop("id"),e.disabled?this.disablePanel():this.enablePanel()},handles:"w,e",handleOptions:{clss:"handle",ratio:0,thickness:25},panelClass:"panel",enablePanel:function(){return this.panelEnabled=!0,this.$el.addClass(this.panelClass+"-enabled").removeClass(this.panelClass+"-disabled"),this.model.set(this.__minmax__),this},disablePanel:function(){var e=this.model;this.panelEnabled=!1,this.__minmax__={minWidth:e.get("minWidth"),maxWidth:e.get("maxWidth")},e.set({minWidth:e.get("width"),maxWidth:e.get("width")}),this.$el.addClass(this.panelClass+"-disabled").removeClass(this.panelClass+"-enabled")}})}}),define("__backbone-panels/panel-data-parser",["require","exports","module","lodash"],function(e,n,t){var a=e("lodash"),i=/[0-9.]+%/,l={x:["minLeft","left","maxLeft","minWidth","width","maxWidth"],y:["minTop","top","maxTop","minHeight","height","maxHeight"]};t.exports=function(e){var n=this.$el.width(),t=this.$el.height();return a.each(l.x,function(t){if(e[t]&&i.test(e[t])){var a=1*parseFloat(e[t])/100;e[t]=a*n}}),a.each(l.y,function(n){if(e[n]&&i.test(e[n])){var a=1*parseFloat(e[n])/100;e[n]=a*t}}),e}}),define("__backbone-panels/iterators",["require","exports","module","lodash"],function(e,n){var t=e("lodash"),a=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","findIndex","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];t.each(a,function(e){n[e]=function(){var n=Array.prototype.slice.call(arguments);return n.unshift(this.panels),t[e].apply(t,n)}}),n.panelIndex=function(e){return this.findIndex(function(n){return n.cid===e.cid})},n.before=function(e){return this.first(e)},n.after=function(e){return this.rest(e+1)},n.reduceBefore=function(e,n,a,i){var l=this.before(e);return t.reduce(l,n,a,i)},n.reduceAfter=function(e,n,a,i){var l=this.after(e);return t.reduce(l,n,a,i)}}),define("__backbone-panels/panel-config",["require","exports","module"],function(e,n){n.sumBefore=function(e,n){return this.reduceBefore(n,function(n,t){return n+t.get(e)},0)},n.sumAfter=function(e,n){return this.reduceAfter(n,function(n,t){return n+t.get(e)},0)},n.calculateLeftPos=function(e){return this.sumBefore("width",e)},n.postitionPanel=function(e){var n=this.panelIndex(e),t=this.calculateLeftPos(n);e.model.set({left:t,top:0})},n.setPanelRightBoundaries=function(e){var n=this.panelIndex(e),t=this.sumAfter("minWidth",n),a=this.sumAfter("maxWidth",n),i=this.sumAfter("width",-1);e.model.set("maxRight",i-t),e.model.set("minRight",i-a)},n.setPanelLeftBoundaries=function(e){var n=this.panelIndex(e),t=this.sumBefore("maxWidth",n),a=this.sumBefore("minWidth",n);e.model.set("maxLeft",t),e.model.set("minLeft",a)},n.arrange=function(){this.each(function(e,n){0===n?e.disableHandle("w"):n===this.panels.length-1&&e.disableHandle("e"),this.postitionPanel(e),this.setPanelRightBoundaries(e),this.setPanelLeftBoundaries(e)},this)}}),define("__backbone-panels/event-handlers",["require","exports","module","lodash"],function(e,n){e("lodash");n.handlePanelResize=function(e,n){if("panels-control"!==n.agent){var t,a,i=this.panelIndex(e),l=Math.abs(n.delta);"expand"===n.action?"w"===n.handle?(t=this.before(i),this.contractPanelsToLeft(t,l)):"e"===n.handle&&(a=this.after(i),this.contractPanelsToRight(a,l)):"contract"===n.action&&("w"===n.handle?(t=this.before(i),this.expandPanelsToRight(t,l)):"e"===n.handle&&(a=this.after(i),this.expandPanelsToLeft(a,l)))}},n.handlePanelResizeStart=function(){},n.handlePanelResizeStop=function(){}}),define("__backbone-panels/actions",["require","exports","module","lodash"],function(e,n){e("lodash");n.contractPanelsToLeft=function(e,n){for(;e.length>0&&0!==n;){var t=e.pop();if(0===e.length)n=t.contractToLeft(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,l=t.moveToLeft(a,{agent:"panels-control"}),s=t.contractToLeft(i+l,{agent:"panels-control"});s&&t.moveToLeft(s,{agent:"panels-control"}),n=a+s}}},n.contractPanelsToRight=function(e,n){for(;e.length>0&&n>0;){var t=e.shift();if(0===e.length)n=t.contractToRight(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,l=t.moveToRight(a,{agent:"panels-control"}),s=t.contractToRight(i+l,{agent:"panels-control"});s&&t.moveToRight(s,{agent:"panels-control"}),n=a+s}}},n.expandPanelsToLeft=function(e,n){for(;e.length>0&&0!==n;){var t=e.shift();if(0===e.length)n=t.expandToLeft(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,l=t.moveToLeft(a,{agent:"panels-control"}),s=t.expandToLeft(i+l,{agent:"panels-control"});s&&t.moveToLeft(s,{agent:"panels-control"}),n=a+s}}},n.expandPanelsToRight=function(e,n){for(;e.length>0&&0!==n;){var t=e.pop();if(0===e.length)n=t.expandToRight(n,{agent:"panels-control"});else{var a=n/1.5,i=n-a,l=t.moveToRight(a,{agent:"panels-control"}),s=t.expandToRight(i+l,{agent:"panels-control"});s&&t.moveToRight(s,{agent:"panels-control"}),n=a+s}}}}),define("__backbone-panels/enable-disable",["require","exports","module"],function(e,n){n.enablePanel=function(e){return this.getPanelById(e).enablePanel(),this},n.disablePanel=function(e){return this.getPanelById(e).disablePanel(),this},n.enablePanelAt=function(e){return this.getPanelAt(e).enablePanel(),this},n.disablePanelAt=function(e){return this.getPanelAt(e).disablePanel(),this}}),define("backbone-panels",["require","exports","module","jquery","lowercase-backbone","lodash","./__backbone-panels/panel-builder","./__backbone-panels/panel-data-parser","./__backbone-panels/iterators","./__backbone-panels/panel-config","./__backbone-panels/event-handlers","./__backbone-panels/actions","./__backbone-panels/enable-disable"],function(e,n,t){var a=e("jquery"),i=e("lowercase-backbone"),l=e("lodash"),s=t.exports=i.view.extend({initialize:function(){i.view.prototype.initialize.apply(this,arguments),this.initializePanels.apply(this,arguments)},initializePanels:function(){l.bindAll(this,"handlePanelResize","handlePanelResizeStart","handlePanelResizeStop"),this.$el.css(this.css),this.panels=[],l.each(this.$el.children(),function(e,n){var t=a(e),i=this.panelDataParser(t.data());i.el=t,this.addPanel(n,i)},this),this.arrange()},panelBuilder:e("./__backbone-panels/panel-builder"),panelTemplate:"<div></div>",panelClass:"panel",panelDataParser:e("./__backbone-panels/panel-data-parser"),addPanel:function(e,n){var t;if(n.el)t=n.el;else{var s=l.isFunction(this.panelTemplate)?this.panelTemplate(n):this.panelTemplate;t=a(s)}t.addClass(this.panelClass).appendTo(this.$el);var o=this.panelBuilder(l.extend(n,{el:t,model:i.model(n)}));this.listenTo(o,"resizestart",this.handlePanelResizeStart).listenTo(o,"resize-x",this.handlePanelResize).listenTo(o,"resizestop",this.handlePanelResizeStop),this.listenTo(o.model,"change:minWidth change:maxWidth",this.arrange),this.panels.splice(e,1,o)},getPanelById:function(e){return this.find(function(n){return n.id===e})},getPanelAt:function(e){return this.panels[e]},css:{position:"relative"}});s.proto(e("./__backbone-panels/iterators")),s.proto(e("./__backbone-panels/panel-config")),s.proto(e("./__backbone-panels/event-handlers")),s.proto(e("./__backbone-panels/actions")),s.proto(e("./__backbone-panels/enable-disable"))});